
<!-- saved from url=(0066)https://codetudau.com/bag-of-words-tf-idf-xu-ly-ngon-ngu-tu-nhien/ -->
<html class=" js flexbox flexboxlegacy canvas canvastext webgl no-touch geolocation postmessage websqldatabase indexeddb hashchange history draganddrop websockets rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms csstransforms3d csstransitions fontface no-generatedcontent video audio localstorage sessionstorage webworkers applicationcache svg inlinesvg smil svgclippaths"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>
    Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên | Code từ đầu - machine learning
    </title>

    

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="https://codetudau.com/favicon.png">

    <!--<link rel="stylesheet" type="text/css" href="/assets/css/screen.css?v=62858937c8" />-->

    <link rel="stylesheet" href="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/bootstrap.min.css">
    <link rel="stylesheet" href="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/monokai_sublime.css">
    <link rel="stylesheet" href="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/default.css">
    <link rel="stylesheet" href="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/elusive-icons.min.css">

    <link rel="shortcut icon" href="https://codetudau.com/favicon.png" type="image/png">
    <link rel="canonical" href="https://codetudau.com/bag-of-words-tf-idf-xu-ly-ngon-ngu-tu-nhien/index.html">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="amphtml" href="https://codetudau.com/bag-of-words-tf-idf-xu-ly-ngon-ngu-tu-nhien/amp/index.html">
    
    <meta property="og:site_name" content="Code từ đầu - machine learning">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên">
    <meta property="og:description" content="Bag of Words là một thuật toán hỗ trợ xử lý ngôn ngữ tự nhiên và mục đích của BoW là phân loại text hay văn bản. Ý tưởng của BoW là phân tích và phân nhóm dựa theo &quot;Bag of Words&quot;(corpus).  Tuy nhiên BoW vẫn tồn tại khuyết điểm, nên TF-IDF là phương pháp khắc phục. Cụ thể ra sao, cùng tìm hiểu nhé. ">
    <meta property="og:url" content="http://localhost:2368/bag-of-words-tf-idf-xu-ly-ngon-ngu-tu-nhien/">
    <meta property="article:published_time" content="2018-01-06T15:01:48.000Z">
    <meta property="article:modified_time" content="2018-01-06T15:09:36.000Z">
    <meta property="article:tag" content="NLP">
    <meta property="article:tag" content="Xử lý ngôn ngữ tự nhiên">
    <meta property="article:tag" content="bag-of-words">
    <meta property="article:tag" content="tf-idf">
    
    <meta property="article:publisher" content="https://www.facebook.com/passion1907">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên">
    <meta name="twitter:description" content="Bag of Words là một thuật toán hỗ trợ xử lý ngôn ngữ tự nhiên và mục đích của BoW là phân loại text hay văn bản. Ý tưởng của BoW là phân tích và phân nhóm dựa theo &quot;Bag of Words&quot;(corpus).  Tuy nhiên BoW vẫn tồn tại khuyết điểm, nên TF-IDF là phương pháp khắc phục. Cụ thể ra sao, cùng tìm hiểu nhé. ">
    <meta name="twitter:url" content="http://localhost:2368/bag-of-words-tf-idf-xu-ly-ngon-ngu-tu-nhien/">
    <meta name="twitter:label1" content="Written by">
    <meta name="twitter:data1" content="T.T.T">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="NLP, Xử lý ngôn ngữ tự nhiên, bag-of-words, tf-idf">
    <meta name="twitter:site" content="@AdwardVn">
    
    <script type="text/javascript" async="" src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/analytics.js.tải xuống"></script><script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "Code từ đầu - machine learning",
        "logo": "http://localhost:2368/content/images/2017/08/kkkkkkkk.png"
    },
    "author": {
        "@type": "Person",
        "name": "T.T.T",
        "url": "http://localhost:2368/author/codetudau/",
        "sameAs": [
            "http://codetudau.com"
        ]
    },
    "headline": "Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên",
    "url": "http://localhost:2368/bag-of-words-tf-idf-xu-ly-ngon-ngu-tu-nhien/",
    "datePublished": "2018-01-06T15:01:48.000Z",
    "dateModified": "2018-01-06T15:09:36.000Z",
    "keywords": "NLP, Xử lý ngôn ngữ tự nhiên, bag-of-words, tf-idf",
    "description": "Bag of Words là một thuật toán hỗ trợ xử lý ngôn ngữ tự nhiên và mục đích của BoW là phân loại text hay văn bản. Ý tưởng của BoW là phân tích và phân nhóm dựa theo &quot;Bag of Words&quot;(corpus).  Tuy nhiên BoW vẫn tồn tại khuyết điểm, nên TF-IDF là phương pháp khắc phục. Cụ thể ra sao, cùng tìm hiểu nhé. ",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://localhost:2368/"
    }
}
    </script>

    <script type="text/javascript" src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/ghost-sdk.js.tải xuống"></script>
<script type="text/javascript">
ghost.init({
	clientId: "ghost-frontend",
	clientSecret: "2575335f4165"
});
</script>
    <meta name="generator" content="Ghost 1.7">
    <link rel="alternate" type="application/rss+xml" title="Code từ đầu - machine learning" href="https://codetudau.com/rss/index.html">

    <!-- Google Analytics -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="" src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/js"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-108925357-1');
    </script>

    <script type="text/javascript" src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/jquery.js.tải xuống"></script>

    <!-- 2017-12-14 add lib vide for display background video -->
    <script type="text/javascript" src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/jquery.vide.min.js.tải xuống"></script>

    <!--<link rel="stylesheet" href="/assets/css/default.css?v=62858937c8">-->

    <script src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/highlight.pack.js.tải xuống"></script>

      <script>hljs.initHighlightingOnLoad();</script>


<script>

</script>
<script src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/embed.js.tải xuống" data-timestamp="1601728487949"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style>._3emE9--dark-theme .-S-tR--ff-downloader{background:rgba(30,30,30,.93);border:1px solid rgba(82,82,82,.54);box-shadow:0 4px 7px rgba(30,30,30,.55);color:#fff}._3emE9--dark-theme .-S-tR--ff-downloader ._6_Mtt--header ._2VdJW--minimize-btn{background:#3d4b52}._3emE9--dark-theme .-S-tR--ff-downloader ._6_Mtt--header ._2VdJW--minimize-btn:hover{background:#131415}._3emE9--dark-theme .-S-tR--ff-downloader ._10vpG--footer{background:rgba(30,30,30,.93)}._2mDEx--white-theme .-S-tR--ff-downloader{background:#fff;border:1px solid rgba(82,82,82,.54);box-shadow:0 4px 7px rgba(30,30,30,.55);color:#314c75}._2mDEx--white-theme .-S-tR--ff-downloader ._6_Mtt--header{font-weight:700}._2mDEx--white-theme .-S-tR--ff-downloader ._2dFLA--container ._2bWNS--notice{border:0;color:rgba(0,0,0,.88)}._2mDEx--white-theme .-S-tR--ff-downloader ._10vpG--footer{background:#fff}.-S-tR--ff-downloader{display:block;overflow:hidden;position:fixed;bottom:20px;right:7.1%;width:330px;height:180px;background:rgba(30,30,30,.93);border-radius:2px;color:#fff;z-index:99999999;border:1px solid rgba(82,82,82,.54);box-shadow:0 4px 7px rgba(30,30,30,.55);transition:.5s}.-S-tR--ff-downloader._3M7UQ--minimize{height:62px}.-S-tR--ff-downloader._3M7UQ--minimize .nxuu4--file-info,.-S-tR--ff-downloader._3M7UQ--minimize ._6_Mtt--header{display:none}.-S-tR--ff-downloader ._6_Mtt--header{padding:10px;font-size:17px;font-family:sans-serif}.-S-tR--ff-downloader ._6_Mtt--header ._2VdJW--minimize-btn{float:right;background:#f1ecec;height:20px;width:20px;text-align:center;padding:2px;margin-top:-10px;cursor:pointer}.-S-tR--ff-downloader ._6_Mtt--header ._2VdJW--minimize-btn:hover{background:#e2dede}.-S-tR--ff-downloader ._13XQ2--error{color:red;padding:10px;font-size:12px;line-height:19px}.-S-tR--ff-downloader ._2dFLA--container{position:relative;height:100%}.-S-tR--ff-downloader ._2dFLA--container .nxuu4--file-info{padding:6px 15px 0;font-family:sans-serif}.-S-tR--ff-downloader ._2dFLA--container .nxuu4--file-info div{margin-bottom:5px;width:100%;overflow:hidden}.-S-tR--ff-downloader ._2dFLA--container ._2bWNS--notice{margin-top:21px;font-size:11px}.-S-tR--ff-downloader ._10vpG--footer{width:100%;bottom:0;position:absolute;font-weight:700}.-S-tR--ff-downloader ._10vpG--footer ._2V73d--loader{animation:n0BD1--rotation 3.5s linear forwards;position:absolute;top:-120px;left:calc(50% - 35px);border-radius:50%;border:5px solid #fff;border-top-color:#a29bfe;height:70px;width:70px;display:flex;justify-content:center;align-items:center}.-S-tR--ff-downloader ._10vpG--footer ._24wjw--loading-bar{width:100%;height:18px;background:#dfe6e9;border-radius:5px}.-S-tR--ff-downloader ._10vpG--footer ._24wjw--loading-bar ._1FVu9--progress-bar{height:100%;background:#8bc34a;border-radius:5px}.-S-tR--ff-downloader ._10vpG--footer ._2KztS--status{margin-top:10px}.-S-tR--ff-downloader ._10vpG--footer ._2KztS--status ._1XilH--state{float:left;font-size:.9em;letter-spacing:1pt;text-transform:uppercase;width:100px;height:20px;position:relative}.-S-tR--ff-downloader ._10vpG--footer ._2KztS--status ._1jiaj--percentage{float:right}</style><link rel="prefetch" as="style" href="https://c.disquscdn.com/next/embed/styles/lounge.6525595c7a9874fa10bd041275e40f17.css"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/common.bundle.e07f4f02bedd02259fb3f3e092970560.js"><link rel="prefetch" as="script" href="https://c.disquscdn.com/next/embed/lounge.bundle.c20816b395a36b788bac6782d6a417ef.js"><link rel="prefetch" as="script" href="https://disqus.com/next/config.js"><script src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/alfalfalfa.0823c767a3bc925f628afd9bed26c958.js.tải xuống" async="" charset="UTF-8"></script></head>
<body><div id="MathJax_Message" style="display: none;"></div>
<div class="container">
<div class="row">
<div class="col-md-2 hidden-sm hidden-xs">

    <div class="logo">
<a class="blog-logo" href="https://codetudau.com/">
        <img class="blog-logo-image" src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/kkkkkkkk.png" alt="Blog Logo">
</a>
    </div>


<h5>Code từ đầu - machine learning</h5>
<hr>
<ul class="list-unstyled menu">
    <li>
        <a href="https://github.com/thanhttvn" target="_blank">
         <i class="el el-github"></i> GitHub
        </a>
    </li>

        <li>
            <a href="https://www.facebook.com/groups/codetudau" target="_blank">
                <i class="el el-facebook"></i> Facebook
            </a>
        </li>

        <li>
            <a href="https://twitter.com/AdwardVn" target="_blank">
                <i class="el el-twitter"></i> @AdwardVn
            </a>
        </li>

    <li>
        <a href="skype:thanhtt.vn93?add" target="_blank">
            <i class="el el-skype"></i> thanhtt.vn93
        </a>

    </li>
</ul>
</div>
<div class="col-md-10 col-xs-12">
    

<a href="https://codetudau.com/" class="read-more"><i class="el el-caret-left read-more"></i> home</a>
<hr>





<main role="main">

    <article class="row post tag-nlp tag-xu-ly-ngon-ngu-tu-nhien tag-bag-of-words tag-tf-idf">

        <header class="col-xs-12">
        <div class="col-md-10 no-margin no-padding post">
            <h1 class="title">
            Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên

            </h1>
             </div>
            <div class="col-md-12">
            </div>

        </header>

        <section class="col-xs-12">
            <div class="kg-card-markdown"><p>Bag of Words là một thuật toán hỗ trợ xử lý ngôn ngữ tự nhiên và mục đích của BoW là phân loại text hay văn bản. Ý tưởng của BoW là phân tích và phân nhóm dựa theo "Bag of Words"(corpus). Với test data mới, tiến hành tìm ra số lần từng từ của test data xuất hiện trong "bag". Tuy nhiên BoW vẫn tồn tại khuyết điểm, nên TF-IDF là phương pháp khắc phục. Bạn có thể ứng dụng BoW + TF-IDF vào việc tìm kiếm, phân loại tài liệu, lọc mail spam xác định ý định của người dùng...</p>
<h1 id="bowhotngnhthno">BoW hoạt động như thế nào ?</h1>
<h2 id="hnhthnhvector">Hình thành vector</h2>
<p>Ví dụ bạn có 2 câu như sau:</p>
<p><mark>The quick brown fox jumps over the lazy dog and</mark><br>
<mark>Never jump over the lazy dog quickly</mark></p>
<p>Từ 2 câu trên, tiến hành tạo từ điển chứa các từ xuất hiện trong từng câu.</p>
<pre><code class="language-python hljs">{
    <span class="hljs-string">'brown'</span>: <span class="hljs-number">0</span>,
    <span class="hljs-string">'dog'</span>: <span class="hljs-number">1</span>,
    <span class="hljs-string">'fox'</span>: <span class="hljs-number">2</span>,
    <span class="hljs-string">'jump'</span>: <span class="hljs-number">3</span>,
    <span class="hljs-string">'jumps'</span>: <span class="hljs-number">4</span>,
    <span class="hljs-string">'lazy'</span>: <span class="hljs-number">5</span>,
    <span class="hljs-string">'never'</span>: <span class="hljs-number">6</span>,
    <span class="hljs-string">'over'</span>: <span class="hljs-number">7</span>,
    <span class="hljs-string">'quick'</span>: <span class="hljs-number">8</span>,
    <span class="hljs-string">'quickly'</span>: <span class="hljs-number">9</span>,
    <span class="hljs-string">'the'</span>: <span class="hljs-number">10</span>,
}
</code></pre>
<p>Dựa vào từ điển vừa tạo, tiến hành tạo vector lưu trữ số lần xuất hiện của từ trong từ điển ứng với mỗi câu.</p>
<p>Và do từ điển đang có 10 từ nên mỗi vector sẽ có 10 phần tử như sau:</p>
<pre><code class="language-python hljs">[<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">2</span>]
[<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>]
</code></pre>
<p>Như các bạn thấy, ví dụ câu 1, "the" xuất hiện 2 lần nên phần tử thứ 10 sẽ mang giá trị 2.</p>
<p>Tương tự "brown", "dog", "fox", "jumps", "lazy", "over", "quick" xuất hiện 1 lần. Và vector chỉ mang giá trị 0 khi từ đó không xuất hiện trong câu như "jump", "over", "quickly"</p>
<h2 id="nhlitrngsvitfidf">Đánh lại trọng số với TF-IDF</h2>
<p>Trong hầu hết các ngôn ngữ, có một số từ có xu hướng xuất hiện thường xuyên như trong tiếng anh có "is", "the"... tương tự tiếng việt có các từ như "là", "của", "cứ"... Chính vì vậy nếu chỉ xét theo tần số xuất hiện của từng từ thì việc phân loại văn bản rất có thể cho kết quả sai dẫn tỷ lệ chính xác sẽ thấp. Vậy giải pháp là gì ?</p>
<p>Phương pháp phổ biến là sử dụng một phương pháp thống kê có tên là <strong>TF-IDF</strong>, giá trị <strong>TF-IDF</strong> của một từ là một con số thu được qua thống kê thể hiện mức độ quan trọng của từ này trong một văn bản, mà bản thân văn bản đang xét nằm trong một tập hợp các văn bản.</p>
<p>Mà tại sao phương pháp lại có tên là <strong>TF-IDF</strong>.</p>
<p>Đầu tiên, TF(Term Frequency) là tần số xuất hiện của 1 từ trong 1 văn bản có cách tính như sau:</p>
<div style="max-width:30%">
<p><img src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/tf-1.svg" alt="tf-1"></p>
</div>
<ul>
<li><strong>f(t,d)</strong> - số lần xuất hiện từ t trong văn bản d.</li>
<li>mẫu số là tổng số từ trong văn bản d</li>
</ul>
<p>Tiếp theo là IDF (Inverse Document Frequency): Tần số nghịch của 1 từ trong tập văn bản (corpus).</p>
<p>Mục đích của việc tính IDF là giảm giá trị của các từ thường xuyên xuất hiện như "is", "the"... Do các từ này không mang nhiều ý nghĩa trong việc phân loại văn bản.</p>
<div style="max-width:50%">
<p><img src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/idf.svg" alt="idf"></p>
</div>
* **|D|**: tổng số văn bản trong tập D
* mẫu số là số văn bản có chứa từ t . Nếu từ đó không xuất hiện ở bất cứ 1 văn bản nào trong tập thì mẫu số sẽ bằng 0 =&gt; phép chia cho không không hợp lệ, vì thế với trường hợp này thường cộng thêm 1 vào mẫu số.
<p>Và cuối cùng TF-IDF bằng:</p>
<div style="max-width:50%">
<p><img src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/tfidf.svg" alt="tfidf"></p>
</div>
<p>Những từ có giá trị TF-IDF cao là những từ xuất hiện nhiều trong văn bản này, và xuất hiện ít trong các văn bản khác. Việc này giúp lọc ra những từ phổ biến và giữ lại những từ có giá trị cao (từ khoá của văn bản đó).</p>
<h3 id="pdng">Áp dụng</h3>
<p>Dưới đây là code thực hiện thuật toán trên, mình sẽ tiến hành làm từng bước cho dễ hiểu.</p>
<p>Đầu tiên là bước tạo vector như trên</p>
<pre><code class="language-python hljs">docA = <span class="hljs-string">"the quick brown fox jumps over the lazy dog and"</span>
docB = <span class="hljs-string">"never jump over the lazy dog quickly"</span>

bowA = docA.split(<span class="hljs-string">" "</span>)
bowB = docB.split(<span class="hljs-string">" "</span>)

<span class="hljs-comment">#Create dictionary</span>
word_dict = set(bowA).union(set(bowB))

wordDictA = dict.fromkeys(word_dict, <span class="hljs-number">0</span>)
wordDictB = dict.fromkeys(word_dict, <span class="hljs-number">0</span>)

<span class="hljs-comment">#count the word in bads</span>
<span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> bowA:
    wordDictA[word]+=<span class="hljs-number">1</span>

<span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> bowB:
    wordDictB[word]+=<span class="hljs-number">1</span>
    
wordDictA
<span class="hljs-comment"># {'and': 1,</span>
<span class="hljs-comment">#  'brown': 1,</span>
<span class="hljs-comment">#  'dog': 1,</span>
<span class="hljs-comment">#  'fox': 1,</span>
<span class="hljs-comment">#  'jump': 0,</span>
<span class="hljs-comment">#  'jumps': 1,</span>
<span class="hljs-comment">#  'lazy': 1,</span>
<span class="hljs-comment">#  'never': 0,</span>
<span class="hljs-comment">#  'over': 1,</span>
<span class="hljs-comment">#  'quick': 1,</span>
<span class="hljs-comment">#  'quickly': 0,</span>
<span class="hljs-comment">#  'the': 2}</span>
</code></pre>
<p><strong>Bước 2: Tính TF</strong></p>
<pre><code class="language-python hljs"><span class="hljs-comment">#calculate TF</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">compute_TF</span><span class="hljs-params">(word_dict, bow)</span>:</span>
    tf_dict = {}
    bow_count = len(bow)
    <span class="hljs-keyword">for</span> word, count <span class="hljs-keyword">in</span> word_dict.iteritems():
        tf_dict[word] = count/float(bow_count)
    
    <span class="hljs-keyword">return</span> tf_dict    
    
tf_bowA = compute_TF(wordDictA, bowA)
tf_bowB = compute_TF(wordDictB, bowB)
tf_bowB
<span class="hljs-comment"># {'and': 0.0,</span>
<span class="hljs-comment">#  'brown': 0.0,</span>
<span class="hljs-comment">#  'dog': 0.14285714285714285,</span>
<span class="hljs-comment">#  'fox': 0.0,</span>
<span class="hljs-comment">#  'jump': 0.14285714285714285,</span>
<span class="hljs-comment">#  'jumps': 0.0,</span>
<span class="hljs-comment">#  'lazy': 0.14285714285714285,</span>
<span class="hljs-comment">#  'never': 0.14285714285714285,</span>
<span class="hljs-comment">#  'over': 0.14285714285714285,</span>
<span class="hljs-comment">#  'quick': 0.0,</span>
<span class="hljs-comment">#  'quickly': 0.14285714285714285,</span>
<span class="hljs-comment">#  'the': 0.14285714285714285}</span>
</code></pre>
<p><strong>Bước 3: Tính IDF</strong></p>
<pre><code class="language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">compute_IDF</span><span class="hljs-params">(doc_list)</span>:</span>
    <span class="hljs-keyword">import</span> math
    idf_dict = {}
    N = len(doc_list)
    
    <span class="hljs-comment">#count number of documents that contain this word</span>
    idf_dict = dict.fromkeys(doc_list[<span class="hljs-number">0</span>].keys(), <span class="hljs-number">0</span>)
    <span class="hljs-keyword">for</span> doc <span class="hljs-keyword">in</span> doc_list:
        <span class="hljs-keyword">for</span> word, count <span class="hljs-keyword">in</span> doc.iteritems():
            <span class="hljs-keyword">if</span> count &gt; <span class="hljs-number">0</span>:
                idf_dict[word] += <span class="hljs-number">1</span>
                
    <span class="hljs-keyword">for</span> word, count <span class="hljs-keyword">in</span> idf_dict.iteritems():
        idf_dict[word] = math.log(N/float(count))
        
    <span class="hljs-keyword">return</span> idf_dict
</code></pre>
<pre><code class="language-python hljs">idfs = compute_IDF([wordDictA, wordDictB])
idfs
<span class="hljs-comment"># {'and': 0.6931471805599453,</span>
<span class="hljs-comment">#  'brown': 0.6931471805599453,</span>
<span class="hljs-comment">#  'dog': 0.0,</span>
<span class="hljs-comment">#  'fox': 0.6931471805599453,</span>
<span class="hljs-comment">#  'jump': 0.6931471805599453,</span>
<span class="hljs-comment">#  'jumps': 0.6931471805599453,</span>
<span class="hljs-comment">#  'lazy': 0.0,</span>
<span class="hljs-comment">#  'never': 0.6931471805599453,</span>
<span class="hljs-comment">#  'over': 0.0,</span>
<span class="hljs-comment">#  'quick': 0.6931471805599453,</span>
<span class="hljs-comment">#  'quickly': 0.6931471805599453,</span>
<span class="hljs-comment">#  'the': 0.0}</span>
</code></pre>
<p><strong>Cuối cùng: Tính TF-IDF</strong></p>
<p>Từ kết quả TF và IDF phía trên chúng ta chỉ cần nhân lại là xong</p>
<pre><code class="language-python hljs"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">compute_TFIDF</span><span class="hljs-params">(tf_bow, idfs)</span>:</span>
    tfidf = {}
    <span class="hljs-keyword">for</span> word, val <span class="hljs-keyword">in</span> tf_bow.iteritems():
        tfidf[word] = val*idfs[word]
    <span class="hljs-keyword">return</span> tfidf

tfidf_bowA = compute_TFIDF(tf_bowA, idfs)
tfidf_bowB = compute_TFIDF(tf_bowB, idfs)
</code></pre>
<pre><code class="language-python hljs">df = pd.DataFrame([tfidf_bowA, tfidf_bowB])
df
</code></pre>
<p><img src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/----------2018-01-06-21.02.52.png" alt="----------2018-01-06-21.02.52"></p>
<p>Từ kết quả trên có thể nhìn thấy những từ có trọng số càng cao thì những từ đó càng có giá trị phân loại và ngược lại ví dụ như từ "the" xuất hiện nhiều nên sẽ không có giá trị phân loại các văn bản với nhau. Tuy nhiên bộ train data lần này ít nên hiệu quả không rõ rệt, nếu bạn thử trên lượng data lớn chắc chắn sẽ rất hiệu quả.</p>
<p>Kết luận</p>
<p>Bài viết này mình đã giới thiệu với các bạn thuật toán Bag of Words và TF-IDF, phương pháp này rất hữu ích trong công việc xử lý ngôn ngữ tự nhiên, lọc mail spam, tìm kiếm ... Ngoài cách code như trên, bạn hoàn toàn có thể dùng thư viện của sklearn <a href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html">tại đây</a>. Hẹn gặp lại các bạn bài viết sau.</p>
</div>
        </section>

        <footer class="col-xs-12 author">

            <hr>


        </footer>

    </article>

    <!--<div id="disqus_thread" class="post"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = ''; // required: replace example with your forum shortname
        var disqus_identifier = '';
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>-->

    <div id="disqus_thread"><iframe id="dsq-app1335" name="dsq-app1335" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/saved_resource.html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 372px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>
    <script>

        /**
         *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
         *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
        /*
        var disqus_config = function () {
        this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
        };
        */
        (function() { // DON'T EDIT BELOW THIS LINE
            var d = document, s = d.createElement('script');
            s.src = 'https://codetudau.disqus.com/embed.js';
            s.setAttribute('data-timestamp', +new Date());
            (d.head || d.body).appendChild(s);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <!-- <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> -->


</main>


</div>

</div>
</div>

    <footer class="page-footer">
      <div class="container">
        <div class="row">
          <div class="col-xs-6">
          <i class="el el-stop footer-icon"></i>
            © 2019 <a href="https://codetudau.com/">Code từ đầu - machine learning</a> All rights reserved.<br>
          </div>
          <div class="col-xs-6 text-right hidden-sm hidden-xs">Proudly published with <a href="https://ghost.org/">Ghost</a></div>
        </div>
      </div>
    </footer>

    <a href="https://codetudau.com/bag-of-words-tf-idf-xu-ly-ngon-ngu-tu-nhien/index.html#" class="back-to-top"><span class="fa fa-angle-up fa-2x"></span></a>

    

    <script src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/modernizr.js.tải xuống"></script>
    <script type="text/javascript" src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/index.js.tải xuống"></script>
    <script type="text/javascript" async="" src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/MathJax.js.tải xuống">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [["$", "$"], ["\\(", "\\)"]],
            processEscapes: true
        }
    });
    </script>
    <!-- <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> -->

<iframe style="display: none;" src="./Bag of Words (Bow) TF-IDF - Xử lý ngôn ngữ tự nhiên _ Code từ đầu - machine learning_files/saved_resource(1).html"></iframe></body></html>